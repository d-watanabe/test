{"name":"Test　Twilio_Zabbix","tagline":"Test　Use Twilio in Zabbix","body":"# 概要\r\n***\r\nZabbixと連携して、指定した連絡先に電話を掛けるものになります。  \r\nこれにより、Zabbixで障害を検知したら、自動で担当者へ障害が発生したことを電話で伝える事が可能になります。\r\n\r\n## リリースノート\r\n\r\n2014/mm/dd ver.1.0 初公開  \r\n\r\n---\r\n## 使用するファイル\r\n|ファイル名|説明|\r\n|---|---|\r\n|zabbix-twilio.php|Twilioの電話処理を実行させる。|\r\n|config.php|Twilioアカウント情報などのパラメータが設定されている。|\r\n|Twilio.php|Twilio API library|\r\n|zabbix-twilio.php_yyyymmdd.log|スクリプト実行時のログファイル。Twilioのメッセージ内容や、宛先などの情報を記録する。|\r\n|Twilioディレクトリ|Twilio API library(PHP)のディレクトリ。 公式ページからダウンロードする。 [Twilio API Library(PHP)](https://github.com/twilio/twilio-php/archive/latest.zip)|\r\n|ZabbixApiAbstract.class.php|PhpZabbixApi library|\r\n|ZabbixApi.class.php|PhpZabbixApi library|\r\n\r\n\r\n## ファイル説明\r\n### zabbix-twilio.php\r\nzabbix-twilio.phpには、以下の関数が定義されています。\r\n関数に渡している引数については、下記の表を参照してください。\r\n\r\n|関数名|説明|\r\n|---|---|\r\n|TwiML_notice|スクリプト実行時に初回に相手にメッセージを流す処理|\r\n|TwiML_Register|Zabbixの障害対応コメントに対応した旨メッセージを記録|\r\n|TwiML_Retype|キー操作を受付、初回メッセージ以外を相手に流す。|\r\n|__construct|ログファイル作成を行う。|\r\n|log|ログファイルへの出力処理を行う|\r\n\r\n\r\n|EXIT番号|内容|\r\n|---|---|\r\n|0|正常終了|\r\n|1|異常終了|\r\n\r\n\r\n|引数名|説明|\r\n|---|---|\r\n||グループ名|\r\n||ホスト名|\r\n||サービス名|\r\n\r\n\r\n### config.php\r\nconfig.phpは、今回使用する下記パラメータを設定しているファイルです。  \r\n\r\n|パラメータ名|説明|\r\n|---|---|\r\n|$LOG_FILE|ログファイル出力先|\r\n|$URL|Twilioサーバと通信を行う為の、外部公開されたWEBサーバに設置したスクリプトへのURL|\r\n|$ZABBIX_API|ZabbixAPIのファイルパス|\r\n|$ZABBIX_USER|Zabbixに登録されたユーザ名|\r\n|$ZABBIX_PASS|Zabbixに登録されたユーザのパスワード|\r\n\r\n\r\n### zabbix-twilio.php_yyyymmdd.log\r\nzabbix-twilio.php_yyyymmdd.logは、Twilioの電話処理結果や、引数確認等のエラー内容を下記の形式で書き込まれます。\r\n> \r\nログ形式：  \r\n日時は、\"yyyy/mm/dd hh:mm:ss\"の書式で出力します。  \r\n・エラーの場合  \r\n発生日時 エラー内容  \r\n・処理が正常に行われた場合\r\n発生日時 Twilioの電話処理履歴から取得できるすべての情報。\r\n> \r\n\r\n## ファイル設置場所\r\n各ファイルは、下記のように設置する必要があります。（ログファイルは、スクリプトを実行すると自動で作成されます。）\r\n\r\n|設置場所|ファイル名|\r\n|---|---|\r\n|/var/www/html/|zabbix-twilio.php、config.php|\r\n|/var/www/html/logs/|zabbix-twilio.php_yyyymmdd.log|\r\n|/usr/lib/zabbix/alertscripts/zabbix-twilio/lib/twilio/|Twilio.php、Twilioディレクトリ（Twilio API library）|\r\n|/usr/lib/zabbix/alertscripts/zabbix-twilio/lib/PhpZabbixApi/|ZabbixApiAbstract.class.php、ZabbixApi.class.php|\r\n\r\n\r\n## 動作確認環境\r\n* Zabbix 2.2.2\r\n* PHP 5.3.3\r\n\r\n\r\n## 実行方法\r\n  \r\n----\r\n\r\n#### 連絡先\r\nmail : \r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}